# ====================================
# 마음이음 (MindConnect) 백엔드 환경변수
# ====================================
#
# 환경별 설정 가이드:
# - 개발 환경: cp .env.example .env
# - 프로덕션: .env 파일 생성 후 EC2에 직접 배치
#
# ⚠️ 보안 주의: .env 파일은 Git에 커밋하지 마세요!

# ====================================
# 개발 환경 (Development)
# ====================================

# Server Configuration
NODE_ENV=development
PORT=8080
HOST=0.0.0.0

# Database Configuration
# 개발 환경: docker-compose.dev.yml 사용 시
DATABASE_URL="mysql://mindconnect_user:mindconnect_pass@mysql:3306/mindconnect"
MYSQL_ROOT_PASSWORD=root_password_change_me
MYSQL_DATABASE=mindconnect
MYSQL_USER=mindconnect_user
MYSQL_PASSWORD=mindconnect_pass

# Redis Configuration
# Redis URL for caching (format: redis://[host]:[port])
# 개발 환경: docker-compose.dev.yml 사용 시
REDIS_URL="redis://redis:6379"
# Cache TTL in seconds (default: 300 = 5 minutes)
REDIS_TTL=300

# JWT Configuration
JWT_SECRET=dev_jwt_secret_change_in_production
JWT_EXPIRES_IN=24h

# API Configuration
API_PREFIX=/api/v1
# 개발 환경: 프론트엔드가 localhost:3000에서 실행
CORS_ORIGIN=http://localhost:3000
# 프로덕션 환경에서는 Nginx reverse proxy를 사용하므로:
# CORS_ORIGIN=http://YOUR_EC2_PUBLIC_IP 또는 CORS_ORIGIN=*

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# External APIs
KAKAO_API_KEY=your_kakao_rest_api_key_here

# Logging
LOG_LEVEL=debug

# Security
ENCRYPTION_KEY=your_aes_256_encryption_key_here

# Sentry Error Tracking (Sprint 2 - Task 4.4.3)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENABLED=false
SENTRY_TRACES_SAMPLE_RATE=1.0
SENTRY_PROFILES_SAMPLE_RATE=1.0
APP_VERSION=1.0.0

# ==========================================
# Phase 2 Sprint 5: Hybrid Recommendation
# ==========================================

# OpenAI Configuration
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_ORG_ID=                              # Optional: Organization ID for billing
OPENAI_EMBEDDING_MODEL=text-embedding-3-large
OPENAI_MAX_RETRIES=3
OPENAI_TIMEOUT=10000                        # milliseconds

# Qdrant Vector Database
QDRANT_URL=http://localhost:6333            # dev: localhost:6333, prod: qdrant:6333
QDRANT_API_KEY=                             # Optional: API key for authentication
QDRANT_COLLECTION_NAME=centers
QDRANT_VECTOR_SIZE=3072                     # text-embedding-3-large dimension

# Hybrid Recommendation Weights
DEFAULT_EMBEDDING_WEIGHT=0.3                # Semantic similarity weight (0-1)
DEFAULT_RULE_WEIGHT=0.7                     # Rule-based score weight (0-1)
# Note: EMBEDDING_WEIGHT + RULE_WEIGHT must equal 1.0

# LLM Service Settings
LLM_RATE_LIMIT_PER_MINUTE=100              # OpenAI free tier: 100 req/min
LLM_MAX_CONCURRENT=5                        # Maximum concurrent requests
LLM_CACHE_TTL=3600                          # Embedding cache TTL (seconds)
CENTER_EMBEDDING_CACHE_TTL=604800           # 7 days for center embeddings
RECOMMENDATION_CACHE_TTL=600                # 10 minutes for recommendations

# Vector Search Settings
VECTOR_SEARCH_TOP_K=20                      # Default number of similar results
VECTOR_SEARCH_THRESHOLD=0.5                 # Minimum similarity score (0-1)

# Batch Processing
EMBEDDING_BATCH_SIZE=10                     # Centers to process per batch
EMBEDDING_BATCH_DELAY=1000                  # Delay between batches (ms)

# ====================================
# 프로덕션 환경 (Production - AWS EC2)
# ====================================
# 프로덕션 배포 시 아래 설정을 참고하여 .env 파일 생성
#
# NODE_ENV=production
# PORT=8080
# HOST=0.0.0.0
#
# # Database (Docker 내부 네트워크)
# DATABASE_URL="mysql://mindconnect_user:STRONG_PASSWORD@mysql:3306/mindconnect"
# MYSQL_ROOT_PASSWORD=STRONG_ROOT_PASSWORD
# MYSQL_DATABASE=mindconnect
# MYSQL_USER=mindconnect_user
# MYSQL_PASSWORD=STRONG_PASSWORD
#
# # Redis (Docker 내부 네트워크)
# REDIS_URL="redis://redis:6379"
# REDIS_PASSWORD=STRONG_REDIS_PASSWORD  # 프로덕션에서는 비밀번호 설정 권장
# REDIS_TTL=300
#
# # JWT (강력한 비밀키 생성 필요)
# JWT_SECRET=GENERATE_STRONG_SECRET_KEY_HERE
# JWT_EXPIRES_IN=24h
#
# # API Configuration
# API_PREFIX=/api/v1
# CORS_ORIGIN=http://YOUR_EC2_PUBLIC_IP  # 또는 도메인
#
# # Qdrant (Docker 내부 네트워크)
# QDRANT_URL=http://qdrant:6333
#
# # External APIs (실제 프로덕션 키 사용)
# KAKAO_API_KEY=실제_카카오_REST_API_키
# OPENAI_API_KEY=실제_OpenAI_API_키
#
# # Logging (프로덕션에서는 info 레벨 권장)
# LOG_LEVEL=info
#
# # Sentry (에러 트래킹 활성화)
# SENTRY_ENABLED=true
# SENTRY_DSN=실제_Sentry_DSN
# SENTRY_TRACES_SAMPLE_RATE=0.1  # 프로덕션에서는 샘플링 비율 낮춤
